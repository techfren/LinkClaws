{"version":3,"sources":["../src/clawdbot.ts"],"sourcesContent":["import type { AgentTool } from '@mariozechner/pi-agent-core'\nimport type { TSchema } from '@sinclair/typebox'\nimport { toJSONSchema } from 'zod'\n\nimport { ListToolkit } from './toolkit.js'\nimport type { Tool } from './tools.js'\n\n/** Convert Zod schema to JSON Schema, handling Date types as ISO datetime strings */\nfunction zodToJSONSchema(tool: Tool) {\n    return toJSONSchema(tool.paramsSchema, {\n        unrepresentable: 'any',\n        override: (ctx) => {\n            const def = ctx.zodSchema._zod.def\n            if (def.type === 'date') {\n                ctx.jsonSchema.type = 'string'\n                ctx.jsonSchema.format = 'date-time'\n            }\n        },\n    }) as unknown as TSchema\n}\n\nexport class AgentMailToolkit extends ListToolkit<AgentTool> {\n    protected buildTool(tool: Tool): AgentTool {\n        return {\n            name: tool.name,\n            label: tool.name,\n            description: tool.description,\n            parameters: zodToJSONSchema(tool),\n            execute: async (_toolCallId, args) => {\n                const result = await tool.func(this.client, tool.paramsSchema.parse(args))\n                return {\n                    content: [{ type: 'text', text: JSON.stringify(result) }],\n                    details: result,\n                }\n            },\n        }\n    }\n}\n"],"mappings":";;;;;AAEA,SAAS,oBAAoB;AAM7B,SAAS,gBAAgB,MAAY;AACjC,SAAO,aAAa,KAAK,cAAc;AAAA,IACnC,iBAAiB;AAAA,IACjB,UAAU,CAAC,QAAQ;AACf,YAAM,MAAM,IAAI,UAAU,KAAK;AAC/B,UAAI,IAAI,SAAS,QAAQ;AACrB,YAAI,WAAW,OAAO;AACtB,YAAI,WAAW,SAAS;AAAA,MAC5B;AAAA,IACJ;AAAA,EACJ,CAAC;AACL;AAEO,IAAM,mBAAN,cAA+B,YAAuB;AAAA,EAC/C,UAAU,MAAuB;AACvC,WAAO;AAAA,MACH,MAAM,KAAK;AAAA,MACX,OAAO,KAAK;AAAA,MACZ,aAAa,KAAK;AAAA,MAClB,YAAY,gBAAgB,IAAI;AAAA,MAChC,SAAS,OAAO,aAAa,SAAS;AAClC,cAAM,SAAS,MAAM,KAAK,KAAK,KAAK,QAAQ,KAAK,aAAa,MAAM,IAAI,CAAC;AACzE,eAAO;AAAA,UACH,SAAS,CAAC,EAAE,MAAM,QAAQ,MAAM,KAAK,UAAU,MAAM,EAAE,CAAC;AAAA,UACxD,SAAS;AAAA,QACb;AAAA,MACJ;AAAA,IACJ;AAAA,EACJ;AACJ;","names":[]}